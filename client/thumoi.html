<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Th∆∞ M·ªùi T·ªët Nghi·ªáp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap"
      rel="stylesheet"
    />
    <style>
      #studentAvatar {
        object-fit: cover;
        cursor: grab;
        user-select: none;
        position: absolute;
        top: 0;
        left: 0;
      }

      #invitation {
        font-family: "Arial", sans-serif;
        overflow: hidden;
      }

      .thu-moi {
        font-family: "Dancing Script", cursive;
        font-size: 40px;
        color: #facc15; /* m√†u v√†ng */
        font-weight: bold;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
      }

      #studentName {
        font-size: 24px;
        font-weight: bold;
        color: #dc2626;
      }

      #invitation p,
      #invitation h2,
      #invitation h1 {
        text-shadow: 0.5px 0.5px 1px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body class="bg-gray-100 p-6">
    <div class="text-center mb-6">
      <h2 class="text-2xl font-bold text-blue-700">üéì Thi·ªáp M·ªùi T·ªët Nghi·ªáp</h2>
    </div>

    <div
      id="invitation"
      class="relative mx-auto w-[900px] h-[600px] shadow-xl rounded-lg border bg-[url('./images/backgroundThuMoi.png')] bg-cover bg-center"
    >
      <!-- B√™n tr√°i: Avatar -->
      <div
        class="absolute top-[100px] left-[30px] w-[350px] h-[400px] flex flex-col items-center z-10"
      >
        <div
          id="avatarWrapper"
          class="w-[260px] h-[260px] rounded-full bg-[url('./images/khungThuMoi.png')] bg-cover bg-center relative overflow-hidden"
        >
          <img
            id="studentAvatar"
            src="https://cdn-icons-png.flaticon.com/512/149/149071.png"
            width="260"
            height="260"
            alt="Avatar"
          />
        </div>
        <h2 class="text-3xl italic font-semibold text-gray-800 mt-3">
          Graduation <span class="text-yellow-700">2025</span>
        </h2>
      </div>

      <!-- B√™n ph·∫£i: N·ªôi dung -->
      <div class="absolute top-[40px] left-[420px] w-[460px] text-left z-10">
        <div class="flex items-center justify-start space-x-3 mb-2">
          <img src="./images/logo-hutech-1.png" class="h-10" />
          <img src="./images/logo30nam.png" class="h-10" />
          <img src="./images/logototnghiep.png" class="h-10" />
        </div>

        <h1 class="thu-moi mt-2">Th∆∞ m·ªùi</h1>

        <p id="studentName" class="mt-1"></p>

        <p class="italic text-purple-700 text-base mt-2">ƒê·∫øn tham d·ª±</p>

        <h2 class="text-yellow-500 text-lg font-bold mt-2">
          L·ªÑ T·ªêT NGHI·ªÜP & TRAO B·∫∞NG K·ª∏ S∆Ø
        </h2>
        <h2 class="text-blue-800 text-lg font-semibold tracking-wide mb-1">
          KHOA C√îNG NGH·ªÜ TH√îNG TIN
        </h2>

        <p class="text-base mt-3">
          Th·ª© 4, <strong>18/6/2025</strong><br />
          <strong>13:00 - 16:00</strong>
        </p>

        <p class="text-sm text-gray-800 italic mt-2">
          ƒê·ªãa ƒëi·ªÉm: E3-05.01, HUTECH - Th·ªß ƒê·ª©c Campus
        </p>
      </div>
    </div>

    <!-- N√∫t -->
    <div class="mt-10 text-center">
      <label
        for="fileInput"
        class="inline-block bg-green-600 text-white px-4 py-2 rounded shadow hover:bg-green-700 cursor-pointer mr-4"
      >
        üì§ Ch·ªçn ·∫£nh t·ª´ m√°y
      </label>
      <input type="file" id="fileInput" accept="image/*" class="hidden" />

      <button
        onclick="captureImage()"
        class="inline-block bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700"
      >
        üì∏ T·∫°o ·∫£nh & L∆∞u
      </button>
    </div>

    <script>
      // G√°n t√™n sinh vi√™n t·ª´ localStorage
      const name = localStorage.getItem("fullname") || "Sinh vi√™n";
      document.getElementById("studentName").innerText = name;

      // ƒê·ªïi ·∫£nh avatar khi ch·ªçn file
      document.getElementById("fileInput").addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          document.getElementById("studentAvatar").src = reader.result;
        };
        reader.readAsDataURL(file);
      });

      // Ch·ª•p ·∫£nh t·ª´ HTML
      function captureImage() {
        html2canvas(document.getElementById("invitation")).then((canvas) => {
          const dataUrl = canvas.toDataURL("image/png");
          const link = document.createElement("a");
          link.href = dataUrl;
          link.download = "thu-moi-tot-nghiep.png";
          link.click();
        });
      }

      // K√©o v√† zoom ·∫£nh avatar
      const avatar = document.getElementById("studentAvatar");
      let isDragging = false,
        startX = 0,
        startY = 0,
        translateX = 0,
        translateY = 0,
        scale = 1;

      avatar.addEventListener("mousedown", (e) => {
        isDragging = true;
        startX = e.clientX - translateX;
        startY = e.clientY - translateY;
        avatar.style.cursor = "grabbing";
      });

      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
        translateX = e.clientX - startX;
        translateY = e.clientY - startY;
        updateTransform();
      });

      document.addEventListener("mouseup", () => {
        isDragging = false;
        avatar.style.cursor = "grab";
      });

      document
        .getElementById("avatarWrapper")
        .addEventListener("wheel", (e) => {
          e.preventDefault();
          const delta = e.deltaY > 0 ? -0.05 : 0.05;
          scale = Math.min(3, Math.max(0.5, scale + delta));
          updateTransform();
        });

      function updateTransform() {
        avatar.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
      }
    </script>
  </body>
</html>

<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <title>Hệ thống lễ tốt nghiệp</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="./javascripts/trangSV.js" defer></script>
  <script src="./javascripts/thongtin.js" defer></script>
  <script src="./javascripts/login.js" defer></script>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Roboto", sans-serif;
      background-color: #fff;
      color: #000;
    }

    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1002;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 30px;
      background-color: #fff;
      border-bottom: 1px solid #ddd;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
    }

    .header strong {
      font-size: 18px;
    }

    .right-section {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 14px;
    }

    .logout {
      color: #000;
      text-decoration: none;
      font-weight: 500;
    }

    .logout:hover {
      text-decoration: underline;
    }

    .menu-bar {
      padding: 80px 30px 12px;
    }

    .menu-icon {
      display: inline-block;
      width: 20px;
      height: 30px;
      cursor: pointer;
    }

    .menu-icon svg {
      width: 100%;
      height: 100%;
      fill: #000;
    }

    .side-menu {
      position: fixed;
      top: 50px;
      left: -300px;
      width: 260px;
      height: calc(100% - 50px);
      background: #fff;
      box-shadow: 2px 0 8px rgba(0, 0, 0, 0.05);
      padding: 20px;
      transition: left 0.3s ease;
      z-index: 1001;
      border-right: none;
    }

    .side-menu.menu-open {
      left: 0 !important;
    }

    .side-menu h3 {
      color: #0d6efd;
      font-size: 18px;
      margin-bottom: 20px;
    }

    .side-menu .close-btn {
      text-align: right;
      margin-bottom: 5px;
    }

    .side-menu .close-btn i {
      font-size: 18px;
      cursor: pointer;
      color: #999;
    }

    .side-menu a {
      display: flex;
      align-items: center;
      gap: 10px;
      color: #000;
      text-decoration: none;
      font-size: 14.5px;
      padding: 20px 10px;
      border-bottom: 1px solid #f0f0f0;
      transition: background 0.25s, padding-left 0.2s;
    }

    .side-menu a:hover {
      background-color: #f5f5f5;
      padding-left: 16px;
    }

    .side-menu a.active {
      background-color: #e9f3ff;
      font-weight: bold;
      border-left: 4px solid #0d6efd;
      padding-left: 16px;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: transparent;
      display: none;
      z-index: 1000;
    }

    .overlay.active {
      display: block;
    }

    .content-section {
      padding: 30px;
      margin-left: 280px;
      margin-top: 100px;
    }
  </style>
</head>

<body>
  <!-- HEADER -->
  <div class="header">
    <div style="display: flex; align-items: center; gap: 15px">
      <img src="./images/logo-hutech-1.png" alt="logo" style="width: 120px; height: 40px; object-fit: contain" />
      <strong>Hệ thống lễ tốt nghiệp</strong>
    </div>

    <div class="right-section">
      <div>Xin Chào, <span id="mssv">---</span></div>
      <a href="#" class="logout" onclick="logout()">Đăng xuất</a>
    </div>
  </div>

  <div class="menu-bar">
    <div class="menu-icon" onclick="toggleMenu(true)">
      <svg viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg">
        <rect width="100" height="12" rx="6"></rect>
        <rect y="30" width="100" height="12" rx="6"></rect>
        <rect y="60" width="100" height="12" rx="6"></rect>
      </svg>
    </div>
  </div>

  <!-- SIDEBAR -->
  <div class="side-menu" id="sideMenu">
    <div class="close-btn">
      <i class="fas fa-times" onclick="toggleMenu(false)"></i>
    </div>
    <h3>MENU</h3>
    <a href="#" onclick="loadSection('trangchuSV.html', 'info')" class="active">
      <i class="fas fa-home"></i> Trang Chủ
    </a>

    <a href="#" onclick="loadSection('thongtincanhan.html', 'info')"><i class="fas fa-user"></i> Thông tin cá nhân</a>
    <a href="#" onclick="loadSection('dangkitotnghiep.html', 'info')">
      <i class="fas fa-edit"></i> Đăng Kí Tốt Nghiệp
    </a>

    <a href="#" onclick="loadSection('thumoi.html', 'info', event)">
      <i class="fas fa-envelope"></i> Thư Mời
    </a>

    <a href="taikhoan.html"><i class="fas fa-id-card"></i> Tài Khoản</a>
    <a href="#" class="logout-link" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a>
  </div>

  <div class="overlay" id="overlay" onclick="toggleMenu(false)"></div>

  <!-- CONTENT -->
  <div id="info" class="content-section"></div>

  <!-- TOGGLE MENU FUNCTION -->
  <script>
    function toggleMenu(show) {
      const menu = document.getElementById("sideMenu");
      const overlay = document.getElementById("overlay");
      if (show) {
        menu.classList.add("menu-open");
        overlay.classList.add("active");
      } else {
        menu.classList.remove("menu-open");
        overlay.classList.remove("active");
      }
    }

    // Gọi file và inject vào content
    function loadSection(path, targetId, event) {
      fetch(path)
        .then((res) => res.text())
        .then((html) => {
          const target = document.getElementById(targetId);
          target.innerHTML = html;

          // Gọi script sau khi inject xong
          if (path.includes("thumoi")) {
            const data = localStorage.getItem("studentInfo");
            if (data) {
              const student = JSON.parse(data);
              const span = document.getElementById("studentName");
              if (student?.fullname && span) {
                span.textContent = student.fullname;
              }
            }
          }

          // Active menu
          document
            .querySelectorAll(".side-menu a")
            .forEach((el) => el.classList.remove("active"));
          if (event?.currentTarget)
            event.currentTarget.classList.add("active");
        })
        .catch((err) => {
          document.getElementById(targetId).innerHTML =
            "Không thể tải nội dung.";
          console.error("Lỗi:", err);
        });

      toggleMenu(false);
    }
  </script>
</body>

</html>